"""
Copyright 2018 Philipp Lucas, philipp.lucas@dlr.de

A collection of functions that generate a 2d support over example probability density functions.

In general these functions return:

  * a 2d array of density values

"""

import itertools
import numpy as np

from scipy.stats import norm, multivariate_normal, gaussian_kde

import utils
import plotting

#### helpers to construct distributions and the like ####

DEFAULT_N = 50


def pdf_gauss_1d(x):
    """Returns the density of the univariate normal distribution at point x."""
    return norm.pdf(x)


def pdf_gauss_2d(x, y):
    """Returns the density of the bivariate normal distribution at point (x,y)."""
    return pdf_gauss_1d(x)*pdf_gauss_1d(y)


def support_gaussian_2d(mu=[0.0, 0.0], sigma=[[1.0, 0], [0, 1]], n=DEFAULT_N):
    """Generate support data for a specified multivariate gaussian and n steps along all dimensions.

    Returns:
        dict of x, y and pdf, where x and y are the grid axis support points and pdf the support points.
    """

    assert(len(mu) == len(sigma) == 2)

    pos = utils.grid_points(n)
    rv = multivariate_normal(mu, sigma)

    return {
        'x': pos[:, :, 0],
        'y': pos[:, :, 1],
        'pdf': rv.pdf(pos)
    }


def kde_kernel(data, kernel_bandwidth=None):
    """Given data return a gaussian kernel density estimator.

    Args:
        data : the data
        kernel_bandwidth : see scipy.stats.gaussian_kde arguments
    """
    return gaussian_kde(data, bw_method=kernel_bandwidth)


def support_kde(kernel, n=DEFAULT_N):
    """Generate data for a kernel estimator `kernel`.

    Args:
        kernel : a kernel density estimator like scipy.stats.gaussian_kde arguments
        n : number of support points per axis
    """
    x = np.linspace(0, 1, n)
    y = np.linspace(0, 1, n)
    grid_points = np.array(list(itertools.product(x, y))).transpose()
    pdf = kernel.evaluate(grid_points)

    return {
        'x': x,
        'y': y,
        'pdf': pdf
    }

#### the actual examples : only data generators! ####

def allbus():
    allbus_emp = [-758.92000, 11.68000, 0.00000, -758.92000, 14.84000, 0.00000, -758.92000, 18.00000, 0.00000,
                  -758.92000, 21.16000, 0.00000, -758.92000, 24.32000, 0.00000, -758.92000, 27.48000, 0.00000,
                  -758.92000, 30.64000, 0.00000, -758.92000, 33.80000, 0.00000, -758.92000, 36.96000, 0.00000,
                  -758.92000, 40.12000, 0.00000, -758.92000, 43.28000, 0.00000, -758.92000, 46.44000, 0.00000,
                  -758.92000, 49.60000, 0.00000, -758.92000, 52.76000, 0.00000, -758.92000, 55.92000, 0.00000,
                  -758.92000, 59.08000, 0.00000, -758.92000, 62.24000, 0.00000, -758.92000, 65.40000, 0.00000,
                  -758.92000, 68.56000, 0.00000, -758.92000, 71.72000, 0.00000, -758.92000, 74.88000, 0.00000,
                  -758.92000, 78.04000, 0.00000, -758.92000, 81.20000, 0.00000, -758.92000, 84.36000, 0.00000,
                  -758.92000, 87.52000, 0.00000, -758.92000, 90.68000, 0.00000, -758.92000, 93.84000, 0.00000,
                  -758.92000, 97.00000, 0.00000, -758.92000, 100.16000, 0.00000, -758.92000, 103.32000, 0.00000,
                  -378.96000, 11.68000, 0.00000, -378.96000, 14.84000, 0.00000, -378.96000, 18.00000, 0.00000,
                  -378.96000, 21.16000, 0.00000, -378.96000, 24.32000, 0.00000, -378.96000, 27.48000, 0.00000,
                  -378.96000, 30.64000, 0.00000, -378.96000, 33.80000, 0.00000, -378.96000, 36.96000, 0.00000,
                  -378.96000, 40.12000, 0.00000, -378.96000, 43.28000, 0.00000, -378.96000, 46.44000, 0.00000,
                  -378.96000, 49.60000, 0.00000, -378.96000, 52.76000, 0.00000, -378.96000, 55.92000, 0.00000,
                  -378.96000, 59.08000, 0.00000, -378.96000, 62.24000, 0.00000, -378.96000, 65.40000, 0.00000,
                  -378.96000, 68.56000, 0.00000, -378.96000, 71.72000, 0.00000, -378.96000, 74.88000, 0.00000,
                  -378.96000, 78.04000, 0.00000, -378.96000, 81.20000, 0.00000, -378.96000, 84.36000, 0.00000,
                  -378.96000, 87.52000, 0.00000, -378.96000, 90.68000, 0.00000, -378.96000, 93.84000, 0.00000,
                  -378.96000, 97.00000, 0.00000, -378.96000, 100.16000, 0.00000, -378.96000, 103.32000, 0.00000,
                  1.00000, 11.68000, 0.00000, 1.00000, 14.84000, 0.00000, 1.00000, 18.00000, 0.00090, 1.00000, 21.16000,
                  0.00045, 1.00000, 24.32000, 0.00045, 1.00000, 27.48000, 0.00045, 1.00000, 30.64000, 0.00000, 1.00000,
                  33.80000, 0.00135, 1.00000, 36.96000, 0.00000, 1.00000, 40.12000, 0.00045, 1.00000, 43.28000, 0.00045,
                  1.00000, 46.44000, 0.00045, 1.00000, 49.60000, 0.00000, 1.00000, 52.76000, 0.00045, 1.00000, 55.92000,
                  0.00045, 1.00000, 59.08000, 0.00045, 1.00000, 62.24000, 0.00000, 1.00000, 65.40000, 0.00045, 1.00000,
                  68.56000, 0.00045, 1.00000, 71.72000, 0.00045, 1.00000, 74.88000, 0.00090, 1.00000, 78.04000, 0.00000,
                  1.00000, 81.20000, 0.00000, 1.00000, 84.36000, 0.00000, 1.00000, 87.52000, 0.00000, 1.00000, 90.68000,
                  0.00000, 1.00000, 93.84000, 0.00000, 1.00000, 97.00000, 0.00000, 1.00000, 100.16000, 0.00000, 1.00000,
                  103.32000, 0.00000, 380.96000, 11.68000, 0.00000, 380.96000, 14.84000, 0.00000, 380.96000, 18.00000,
                  0.00538, 380.96000, 21.16000, 0.01211, 380.96000, 24.32000, 0.00942, 380.96000, 27.48000, 0.00673,
                  380.96000, 30.64000, 0.00224, 380.96000, 33.80000, 0.00224, 380.96000, 36.96000, 0.00359, 380.96000,
                  40.12000, 0.00224, 380.96000, 43.28000, 0.00404, 380.96000, 46.44000, 0.00359, 380.96000, 49.60000,
                  0.00269, 380.96000, 52.76000, 0.00583, 380.96000, 55.92000, 0.00583, 380.96000, 59.08000, 0.00135,
                  380.96000, 62.24000, 0.00269, 380.96000, 65.40000, 0.00762, 380.96000, 68.56000, 0.00673, 380.96000,
                  71.72000, 0.00359, 380.96000, 74.88000, 0.00359, 380.96000, 78.04000, 0.00314, 380.96000, 81.20000,
                  0.00090, 380.96000, 84.36000, 0.00045, 380.96000, 87.52000, 0.00090, 380.96000, 90.68000, 0.00000,
                  380.96000, 93.84000, 0.00000, 380.96000, 97.00000, 0.00000, 380.96000, 100.16000, 0.00000, 380.96000,
                  103.32000, 0.00000, 760.92000, 11.68000, 0.00000, 760.92000, 14.84000, 0.00000, 760.92000, 18.00000,
                  0.00448, 760.92000, 21.16000, 0.01031, 760.92000, 24.32000, 0.00404, 760.92000, 27.48000, 0.00807,
                  760.92000, 30.64000, 0.00583, 760.92000, 33.80000, 0.00493, 760.92000, 36.96000, 0.00404, 760.92000,
                  40.12000, 0.00359, 760.92000, 43.28000, 0.00448, 760.92000, 46.44000, 0.00897, 760.92000, 49.60000,
                  0.00852, 760.92000, 52.76000, 0.00717, 760.92000, 55.92000, 0.00717, 760.92000, 59.08000, 0.00628,
                  760.92000, 62.24000, 0.01076, 760.92000, 65.40000, 0.01570, 760.92000, 68.56000, 0.01435, 760.92000,
                  71.72000, 0.00762, 760.92000, 74.88000, 0.00942, 760.92000, 78.04000, 0.00448, 760.92000, 81.20000,
                  0.00404, 760.92000, 84.36000, 0.00135, 760.92000, 87.52000, 0.00045, 760.92000, 90.68000, 0.00000,
                  760.92000, 93.84000, 0.00000, 760.92000, 97.00000, 0.00000, 760.92000, 100.16000, 0.00000, 760.92000,
                  103.32000, 0.00000, 1140.88000, 11.68000, 0.00000, 1140.88000, 14.84000, 0.00000, 1140.88000,
                  18.00000, 0.00045, 1140.88000, 21.16000, 0.00448, 1140.88000, 24.32000, 0.00717, 1140.88000, 27.48000,
                  0.00628, 1140.88000, 30.64000, 0.00493, 1140.88000, 33.80000, 0.00987, 1140.88000, 36.96000, 0.00493,
                  1140.88000, 40.12000, 0.00628, 1140.88000, 43.28000, 0.00852, 1140.88000, 46.44000, 0.01256,
                  1140.88000, 49.60000, 0.01076, 1140.88000, 52.76000, 0.01211, 1140.88000, 55.92000, 0.00673,
                  1140.88000, 59.08000, 0.00583, 1140.88000, 62.24000, 0.00762, 1140.88000, 65.40000, 0.01570,
                  1140.88000, 68.56000, 0.01121, 1140.88000, 71.72000, 0.01121, 1140.88000, 74.88000, 0.01659,
                  1140.88000, 78.04000, 0.01076, 1140.88000, 81.20000, 0.00762, 1140.88000, 84.36000, 0.00314,
                  1140.88000, 87.52000, 0.00179, 1140.88000, 90.68000, 0.00135, 1140.88000, 93.84000, 0.00000,
                  1140.88000, 97.00000, 0.00045, 1140.88000, 100.16000, 0.00000, 1140.88000, 103.32000, 0.00000,
                  1520.84000, 11.68000, 0.00000, 1520.84000, 14.84000, 0.00000, 1520.84000, 18.00000, 0.00000,
                  1520.84000, 21.16000, 0.00314, 1520.84000, 24.32000, 0.00448, 1520.84000, 27.48000, 0.01121,
                  1520.84000, 30.64000, 0.00807, 1520.84000, 33.80000, 0.00538, 1520.84000, 36.96000, 0.01031,
                  1520.84000, 40.12000, 0.00628, 1520.84000, 43.28000, 0.00404, 1520.84000, 46.44000, 0.01345,
                  1520.84000, 49.60000, 0.00942, 1520.84000, 52.76000, 0.00987, 1520.84000, 55.92000, 0.00942,
                  1520.84000, 59.08000, 0.00762, 1520.84000, 62.24000, 0.00583, 1520.84000, 65.40000, 0.00897,
                  1520.84000, 68.56000, 0.00583, 1520.84000, 71.72000, 0.00448, 1520.84000, 74.88000, 0.00807,
                  1520.84000, 78.04000, 0.00762, 1520.84000, 81.20000, 0.00583, 1520.84000, 84.36000, 0.00448,
                  1520.84000, 87.52000, 0.00314, 1520.84000, 90.68000, 0.00045, 1520.84000, 93.84000, 0.00000,
                  1520.84000, 97.00000, 0.00000, 1520.84000, 100.16000, 0.00000, 1520.84000, 103.32000, 0.00000,
                  1900.80000, 11.68000, 0.00000, 1900.80000, 14.84000, 0.00000, 1900.80000, 18.00000, 0.00000,
                  1900.80000, 21.16000, 0.00090, 1900.80000, 24.32000, 0.00404, 1900.80000, 27.48000, 0.00673,
                  1900.80000, 30.64000, 0.00404, 1900.80000, 33.80000, 0.00717, 1900.80000, 36.96000, 0.00359,
                  1900.80000, 40.12000, 0.00538, 1900.80000, 43.28000, 0.00448, 1900.80000, 46.44000, 0.00852,
                  1900.80000, 49.60000, 0.00583, 1900.80000, 52.76000, 0.01031, 1900.80000, 55.92000, 0.01076,
                  1900.80000, 59.08000, 0.00628, 1900.80000, 62.24000, 0.00717, 1900.80000, 65.40000, 0.00583,
                  1900.80000, 68.56000, 0.00448, 1900.80000, 71.72000, 0.00404, 1900.80000, 74.88000, 0.00179,
                  1900.80000, 78.04000, 0.00314, 1900.80000, 81.20000, 0.00359, 1900.80000, 84.36000, 0.00314,
                  1900.80000, 87.52000, 0.00135, 1900.80000, 90.68000, 0.00090, 1900.80000, 93.84000, 0.00000,
                  1900.80000, 97.00000, 0.00000, 1900.80000, 100.16000, 0.00000, 1900.80000, 103.32000, 0.00000,
                  2280.76000, 11.68000, 0.00000, 2280.76000, 14.84000, 0.00000, 2280.76000, 18.00000, 0.00000,
                  2280.76000, 21.16000, 0.00000, 2280.76000, 24.32000, 0.00179, 2280.76000, 27.48000, 0.00493,
                  2280.76000, 30.64000, 0.00628, 2280.76000, 33.80000, 0.00583, 2280.76000, 36.96000, 0.00538,
                  2280.76000, 40.12000, 0.00179, 2280.76000, 43.28000, 0.00359, 2280.76000, 46.44000, 0.00852,
                  2280.76000, 49.60000, 0.00538, 2280.76000, 52.76000, 0.00583, 2280.76000, 55.92000, 0.00673,
                  2280.76000, 59.08000, 0.00314, 2280.76000, 62.24000, 0.00224, 2280.76000, 65.40000, 0.00314,
                  2280.76000, 68.56000, 0.00493, 2280.76000, 71.72000, 0.00269, 2280.76000, 74.88000, 0.00269,
                  2280.76000, 78.04000, 0.00090, 2280.76000, 81.20000, 0.00090, 2280.76000, 84.36000, 0.00090,
                  2280.76000, 87.52000, 0.00000, 2280.76000, 90.68000, 0.00045, 2280.76000, 93.84000, 0.00000,
                  2280.76000, 97.00000, 0.00000, 2280.76000, 100.16000, 0.00000, 2280.76000, 103.32000, 0.00000,
                  2660.72000, 11.68000, 0.00000, 2660.72000, 14.84000, 0.00000, 2660.72000, 18.00000, 0.00000,
                  2660.72000, 21.16000, 0.00000, 2660.72000, 24.32000, 0.00045, 2660.72000, 27.48000, 0.00269,
                  2660.72000, 30.64000, 0.00269, 2660.72000, 33.80000, 0.00179, 2660.72000, 36.96000, 0.00179,
                  2660.72000, 40.12000, 0.00224, 2660.72000, 43.28000, 0.00179, 2660.72000, 46.44000, 0.00807,
                  2660.72000, 49.60000, 0.00359, 2660.72000, 52.76000, 0.00628, 2660.72000, 55.92000, 0.00359,
                  2660.72000, 59.08000, 0.00359, 2660.72000, 62.24000, 0.00359, 2660.72000, 65.40000, 0.00359,
                  2660.72000, 68.56000, 0.00359, 2660.72000, 71.72000, 0.00179, 2660.72000, 74.88000, 0.00269,
                  2660.72000, 78.04000, 0.00045, 2660.72000, 81.20000, 0.00045, 2660.72000, 84.36000, 0.00045,
                  2660.72000, 87.52000, 0.00090, 2660.72000, 90.68000, 0.00000, 2660.72000, 93.84000, 0.00000,
                  2660.72000, 97.00000, 0.00000, 2660.72000, 100.16000, 0.00000, 2660.72000, 103.32000, 0.00000,
                  3040.68000, 11.68000, 0.00000, 3040.68000, 14.84000, 0.00000, 3040.68000, 18.00000, 0.00000,
                  3040.68000, 21.16000, 0.00000, 3040.68000, 24.32000, 0.00090, 3040.68000, 27.48000, 0.00135,
                  3040.68000, 30.64000, 0.00090, 3040.68000, 33.80000, 0.00314, 3040.68000, 36.96000, 0.00224,
                  3040.68000, 40.12000, 0.00135, 3040.68000, 43.28000, 0.00404, 3040.68000, 46.44000, 0.00628,
                  3040.68000, 49.60000, 0.00404, 3040.68000, 52.76000, 0.00404, 3040.68000, 55.92000, 0.00224,
                  3040.68000, 59.08000, 0.00359, 3040.68000, 62.24000, 0.00314, 3040.68000, 65.40000, 0.00224,
                  3040.68000, 68.56000, 0.00359, 3040.68000, 71.72000, 0.00135, 3040.68000, 74.88000, 0.00045,
                  3040.68000, 78.04000, 0.00135, 3040.68000, 81.20000, 0.00045, 3040.68000, 84.36000, 0.00000,
                  3040.68000, 87.52000, 0.00090, 3040.68000, 90.68000, 0.00000, 3040.68000, 93.84000, 0.00000,
                  3040.68000, 97.00000, 0.00000, 3040.68000, 100.16000, 0.00000, 3040.68000, 103.32000, 0.00000,
                  3420.64000, 11.68000, 0.00000, 3420.64000, 14.84000, 0.00000, 3420.64000, 18.00000, 0.00000,
                  3420.64000, 21.16000, 0.00000, 3420.64000, 24.32000, 0.00000, 3420.64000, 27.48000, 0.00045,
                  3420.64000, 30.64000, 0.00179, 3420.64000, 33.80000, 0.00179, 3420.64000, 36.96000, 0.00269,
                  3420.64000, 40.12000, 0.00090, 3420.64000, 43.28000, 0.00314, 3420.64000, 46.44000, 0.00314,
                  3420.64000, 49.60000, 0.00359, 3420.64000, 52.76000, 0.00404, 3420.64000, 55.92000, 0.00224,
                  3420.64000, 59.08000, 0.00404, 3420.64000, 62.24000, 0.00090, 3420.64000, 65.40000, 0.00269,
                  3420.64000, 68.56000, 0.00179, 3420.64000, 71.72000, 0.00090, 3420.64000, 74.88000, 0.00000,
                  3420.64000, 78.04000, 0.00135, 3420.64000, 81.20000, 0.00000, 3420.64000, 84.36000, 0.00000,
                  3420.64000, 87.52000, 0.00045, 3420.64000, 90.68000, 0.00045, 3420.64000, 93.84000, 0.00000,
                  3420.64000, 97.00000, 0.00000, 3420.64000, 100.16000, 0.00000, 3420.64000, 103.32000, 0.00000,
                  3800.60000, 11.68000, 0.00000, 3800.60000, 14.84000, 0.00000, 3800.60000, 18.00000, 0.00000,
                  3800.60000, 21.16000, 0.00000, 3800.60000, 24.32000, 0.00000, 3800.60000, 27.48000, 0.00000,
                  3800.60000, 30.64000, 0.00000, 3800.60000, 33.80000, 0.00045, 3800.60000, 36.96000, 0.00000,
                  3800.60000, 40.12000, 0.00045, 3800.60000, 43.28000, 0.00000, 3800.60000, 46.44000, 0.00045,
                  3800.60000, 49.60000, 0.00090, 3800.60000, 52.76000, 0.00045, 3800.60000, 55.92000, 0.00045,
                  3800.60000, 59.08000, 0.00045, 3800.60000, 62.24000, 0.00000, 3800.60000, 65.40000, 0.00000,
                  3800.60000, 68.56000, 0.00000, 3800.60000, 71.72000, 0.00000, 3800.60000, 74.88000, 0.00045,
                  3800.60000, 78.04000, 0.00000, 3800.60000, 81.20000, 0.00000, 3800.60000, 84.36000, 0.00000,
                  3800.60000, 87.52000, 0.00000, 3800.60000, 90.68000, 0.00000, 3800.60000, 93.84000, 0.00000,
                  3800.60000, 97.00000, 0.00000, 3800.60000, 100.16000, 0.00000, 3800.60000, 103.32000, 0.00000,
                  4180.56000, 11.68000, 0.00000, 4180.56000, 14.84000, 0.00000, 4180.56000, 18.00000, 0.00000,
                  4180.56000, 21.16000, 0.00000, 4180.56000, 24.32000, 0.00000, 4180.56000, 27.48000, 0.00045,
                  4180.56000, 30.64000, 0.00000, 4180.56000, 33.80000, 0.00045, 4180.56000, 36.96000, 0.00090,
                  4180.56000, 40.12000, 0.00045, 4180.56000, 43.28000, 0.00269, 4180.56000, 46.44000, 0.00404,
                  4180.56000, 49.60000, 0.00179, 4180.56000, 52.76000, 0.00135, 4180.56000, 55.92000, 0.00135,
                  4180.56000, 59.08000, 0.00314, 4180.56000, 62.24000, 0.00090, 4180.56000, 65.40000, 0.00045,
                  4180.56000, 68.56000, 0.00000, 4180.56000, 71.72000, 0.00090, 4180.56000, 74.88000, 0.00090,
                  4180.56000, 78.04000, 0.00000, 4180.56000, 81.20000, 0.00000, 4180.56000, 84.36000, 0.00000,
                  4180.56000, 87.52000, 0.00000, 4180.56000, 90.68000, 0.00000, 4180.56000, 93.84000, 0.00000,
                  4180.56000, 97.00000, 0.00000, 4180.56000, 100.16000, 0.00000, 4180.56000, 103.32000, 0.00000,
                  4560.52000, 11.68000, 0.00000, 4560.52000, 14.84000, 0.00000, 4560.52000, 18.00000, 0.00000,
                  4560.52000, 21.16000, 0.00000, 4560.52000, 24.32000, 0.00000, 4560.52000, 27.48000, 0.00000,
                  4560.52000, 30.64000, 0.00000, 4560.52000, 33.80000, 0.00000, 4560.52000, 36.96000, 0.00045,
                  4560.52000, 40.12000, 0.00045, 4560.52000, 43.28000, 0.00045, 4560.52000, 46.44000, 0.00269,
                  4560.52000, 49.60000, 0.00045, 4560.52000, 52.76000, 0.00224, 4560.52000, 55.92000, 0.00090,
                  4560.52000, 59.08000, 0.00090, 4560.52000, 62.24000, 0.00000, 4560.52000, 65.40000, 0.00090,
                  4560.52000, 68.56000, 0.00045, 4560.52000, 71.72000, 0.00000, 4560.52000, 74.88000, 0.00045,
                  4560.52000, 78.04000, 0.00090, 4560.52000, 81.20000, 0.00000, 4560.52000, 84.36000, 0.00000,
                  4560.52000, 87.52000, 0.00000, 4560.52000, 90.68000, 0.00000, 4560.52000, 93.84000, 0.00000,
                  4560.52000, 97.00000, 0.00000, 4560.52000, 100.16000, 0.00000, 4560.52000, 103.32000, 0.00000,
                  4940.48000, 11.68000, 0.00000, 4940.48000, 14.84000, 0.00000, 4940.48000, 18.00000, 0.00000,
                  4940.48000, 21.16000, 0.00000, 4940.48000, 24.32000, 0.00000, 4940.48000, 27.48000, 0.00000,
                  4940.48000, 30.64000, 0.00045, 4940.48000, 33.80000, 0.00045, 4940.48000, 36.96000, 0.00045,
                  4940.48000, 40.12000, 0.00000, 4940.48000, 43.28000, 0.00135, 4940.48000, 46.44000, 0.00000,
                  4940.48000, 49.60000, 0.00135, 4940.48000, 52.76000, 0.00135, 4940.48000, 55.92000, 0.00090,
                  4940.48000, 59.08000, 0.00090, 4940.48000, 62.24000, 0.00000, 4940.48000, 65.40000, 0.00000,
                  4940.48000, 68.56000, 0.00045, 4940.48000, 71.72000, 0.00000, 4940.48000, 74.88000, 0.00000,
                  4940.48000, 78.04000, 0.00000, 4940.48000, 81.20000, 0.00000, 4940.48000, 84.36000, 0.00045,
                  4940.48000, 87.52000, 0.00045, 4940.48000, 90.68000, 0.00000, 4940.48000, 93.84000, 0.00000,
                  4940.48000, 97.00000, 0.00000, 4940.48000, 100.16000, 0.00000, 4940.48000, 103.32000, 0.00000,
                  5320.44000, 11.68000, 0.00000, 5320.44000, 14.84000, 0.00000, 5320.44000, 18.00000, 0.00000,
                  5320.44000, 21.16000, 0.00000, 5320.44000, 24.32000, 0.00000, 5320.44000, 27.48000, 0.00000,
                  5320.44000, 30.64000, 0.00000, 5320.44000, 33.80000, 0.00000, 5320.44000, 36.96000, 0.00000,
                  5320.44000, 40.12000, 0.00045, 5320.44000, 43.28000, 0.00000, 5320.44000, 46.44000, 0.00045,
                  5320.44000, 49.60000, 0.00000, 5320.44000, 52.76000, 0.00000, 5320.44000, 55.92000, 0.00000,
                  5320.44000, 59.08000, 0.00045, 5320.44000, 62.24000, 0.00000, 5320.44000, 65.40000, 0.00000,
                  5320.44000, 68.56000, 0.00000, 5320.44000, 71.72000, 0.00000, 5320.44000, 74.88000, 0.00000,
                  5320.44000, 78.04000, 0.00000, 5320.44000, 81.20000, 0.00000, 5320.44000, 84.36000, 0.00000,
                  5320.44000, 87.52000, 0.00000, 5320.44000, 90.68000, 0.00000, 5320.44000, 93.84000, 0.00000,
                  5320.44000, 97.00000, 0.00000, 5320.44000, 100.16000, 0.00000, 5320.44000, 103.32000, 0.00000,
                  5700.40000, 11.68000, 0.00000, 5700.40000, 14.84000, 0.00000, 5700.40000, 18.00000, 0.00000,
                  5700.40000, 21.16000, 0.00000, 5700.40000, 24.32000, 0.00000, 5700.40000, 27.48000, 0.00000,
                  5700.40000, 30.64000, 0.00000, 5700.40000, 33.80000, 0.00000, 5700.40000, 36.96000, 0.00000,
                  5700.40000, 40.12000, 0.00000, 5700.40000, 43.28000, 0.00000, 5700.40000, 46.44000, 0.00000,
                  5700.40000, 49.60000, 0.00000, 5700.40000, 52.76000, 0.00000, 5700.40000, 55.92000, 0.00000,
                  5700.40000, 59.08000, 0.00045, 5700.40000, 62.24000, 0.00000, 5700.40000, 65.40000, 0.00000,
                  5700.40000, 68.56000, 0.00000, 5700.40000, 71.72000, 0.00000, 5700.40000, 74.88000, 0.00000,
                  5700.40000, 78.04000, 0.00000, 5700.40000, 81.20000, 0.00000, 5700.40000, 84.36000, 0.00000,
                  5700.40000, 87.52000, 0.00000, 5700.40000, 90.68000, 0.00000, 5700.40000, 93.84000, 0.00000,
                  5700.40000, 97.00000, 0.00000, 5700.40000, 100.16000, 0.00000, 5700.40000, 103.32000, 0.00000,
                  6080.36000, 11.68000, 0.00000, 6080.36000, 14.84000, 0.00000, 6080.36000, 18.00000, 0.00000,
                  6080.36000, 21.16000, 0.00000, 6080.36000, 24.32000, 0.00000, 6080.36000, 27.48000, 0.00045,
                  6080.36000, 30.64000, 0.00000, 6080.36000, 33.80000, 0.00045, 6080.36000, 36.96000, 0.00000,
                  6080.36000, 40.12000, 0.00000, 6080.36000, 43.28000, 0.00090, 6080.36000, 46.44000, 0.00090,
                  6080.36000, 49.60000, 0.00135, 6080.36000, 52.76000, 0.00045, 6080.36000, 55.92000, 0.00135,
                  6080.36000, 59.08000, 0.00000, 6080.36000, 62.24000, 0.00000, 6080.36000, 65.40000, 0.00000,
                  6080.36000, 68.56000, 0.00000, 6080.36000, 71.72000, 0.00045, 6080.36000, 74.88000, 0.00045,
                  6080.36000, 78.04000, 0.00000, 6080.36000, 81.20000, 0.00000, 6080.36000, 84.36000, 0.00000,
                  6080.36000, 87.52000, 0.00000, 6080.36000, 90.68000, 0.00000, 6080.36000, 93.84000, 0.00000,
                  6080.36000, 97.00000, 0.00000, 6080.36000, 100.16000, 0.00000, 6080.36000, 103.32000, 0.00000,
                  6460.32000, 11.68000, 0.00000, 6460.32000, 14.84000, 0.00000, 6460.32000, 18.00000, 0.00000,
                  6460.32000, 21.16000, 0.00000, 6460.32000, 24.32000, 0.00000, 6460.32000, 27.48000, 0.00000,
                  6460.32000, 30.64000, 0.00000, 6460.32000, 33.80000, 0.00000, 6460.32000, 36.96000, 0.00000,
                  6460.32000, 40.12000, 0.00000, 6460.32000, 43.28000, 0.00045, 6460.32000, 46.44000, 0.00000,
                  6460.32000, 49.60000, 0.00000, 6460.32000, 52.76000, 0.00000, 6460.32000, 55.92000, 0.00000,
                  6460.32000, 59.08000, 0.00000, 6460.32000, 62.24000, 0.00000, 6460.32000, 65.40000, 0.00000,
                  6460.32000, 68.56000, 0.00000, 6460.32000, 71.72000, 0.00045, 6460.32000, 74.88000, 0.00000,
                  6460.32000, 78.04000, 0.00000, 6460.32000, 81.20000, 0.00000, 6460.32000, 84.36000, 0.00000,
                  6460.32000, 87.52000, 0.00000, 6460.32000, 90.68000, 0.00000, 6460.32000, 93.84000, 0.00000,
                  6460.32000, 97.00000, 0.00000, 6460.32000, 100.16000, 0.00000, 6460.32000, 103.32000, 0.00000,
                  6840.28000, 11.68000, 0.00000, 6840.28000, 14.84000, 0.00000, 6840.28000, 18.00000, 0.00000,
                  6840.28000, 21.16000, 0.00000, 6840.28000, 24.32000, 0.00000, 6840.28000, 27.48000, 0.00000,
                  6840.28000, 30.64000, 0.00000, 6840.28000, 33.80000, 0.00000, 6840.28000, 36.96000, 0.00000,
                  6840.28000, 40.12000, 0.00000, 6840.28000, 43.28000, 0.00000, 6840.28000, 46.44000, 0.00000,
                  6840.28000, 49.60000, 0.00000, 6840.28000, 52.76000, 0.00045, 6840.28000, 55.92000, 0.00045,
                  6840.28000, 59.08000, 0.00000, 6840.28000, 62.24000, 0.00000, 6840.28000, 65.40000, 0.00000,
                  6840.28000, 68.56000, 0.00000, 6840.28000, 71.72000, 0.00000, 6840.28000, 74.88000, 0.00000,
                  6840.28000, 78.04000, 0.00000, 6840.28000, 81.20000, 0.00000, 6840.28000, 84.36000, 0.00000,
                  6840.28000, 87.52000, 0.00000, 6840.28000, 90.68000, 0.00000, 6840.28000, 93.84000, 0.00000,
                  6840.28000, 97.00000, 0.00000, 6840.28000, 100.16000, 0.00000, 6840.28000, 103.32000, 0.00000,
                  7220.24000, 11.68000, 0.00000, 7220.24000, 14.84000, 0.00000, 7220.24000, 18.00000, 0.00000,
                  7220.24000, 21.16000, 0.00000, 7220.24000, 24.32000, 0.00000, 7220.24000, 27.48000, 0.00000,
                  7220.24000, 30.64000, 0.00000, 7220.24000, 33.80000, 0.00000, 7220.24000, 36.96000, 0.00000,
                  7220.24000, 40.12000, 0.00000, 7220.24000, 43.28000, 0.00000, 7220.24000, 46.44000, 0.00000,
                  7220.24000, 49.60000, 0.00000, 7220.24000, 52.76000, 0.00045, 7220.24000, 55.92000, 0.00000,
                  7220.24000, 59.08000, 0.00000, 7220.24000, 62.24000, 0.00000, 7220.24000, 65.40000, 0.00000,
                  7220.24000, 68.56000, 0.00000, 7220.24000, 71.72000, 0.00000, 7220.24000, 74.88000, 0.00000,
                  7220.24000, 78.04000, 0.00000, 7220.24000, 81.20000, 0.00000, 7220.24000, 84.36000, 0.00000,
                  7220.24000, 87.52000, 0.00000, 7220.24000, 90.68000, 0.00000, 7220.24000, 93.84000, 0.00000,
                  7220.24000, 97.00000, 0.00000, 7220.24000, 100.16000, 0.00000, 7220.24000, 103.32000, 0.00000,
                  7600.20000, 11.68000, 0.00000, 7600.20000, 14.84000, 0.00000, 7600.20000, 18.00000, 0.00000,
                  7600.20000, 21.16000, 0.00000, 7600.20000, 24.32000, 0.00000, 7600.20000, 27.48000, 0.00000,
                  7600.20000, 30.64000, 0.00000, 7600.20000, 33.80000, 0.00000, 7600.20000, 36.96000, 0.00000,
                  7600.20000, 40.12000, 0.00000, 7600.20000, 43.28000, 0.00000, 7600.20000, 46.44000, 0.00000,
                  7600.20000, 49.60000, 0.00000, 7600.20000, 52.76000, 0.00045, 7600.20000, 55.92000, 0.00000,
                  7600.20000, 59.08000, 0.00000, 7600.20000, 62.24000, 0.00045, 7600.20000, 65.40000, 0.00000,
                  7600.20000, 68.56000, 0.00045, 7600.20000, 71.72000, 0.00000, 7600.20000, 74.88000, 0.00000,
                  7600.20000, 78.04000, 0.00000, 7600.20000, 81.20000, 0.00000, 7600.20000, 84.36000, 0.00000,
                  7600.20000, 87.52000, 0.00000, 7600.20000, 90.68000, 0.00000, 7600.20000, 93.84000, 0.00000,
                  7600.20000, 97.00000, 0.00000, 7600.20000, 100.16000, 0.00000, 7600.20000, 103.32000, 0.00000,
                  7980.16000, 11.68000, 0.00000, 7980.16000, 14.84000, 0.00000, 7980.16000, 18.00000, 0.00000,
                  7980.16000, 21.16000, 0.00000, 7980.16000, 24.32000, 0.00000, 7980.16000, 27.48000, 0.00000,
                  7980.16000, 30.64000, 0.00000, 7980.16000, 33.80000, 0.00000, 7980.16000, 36.96000, 0.00000,
                  7980.16000, 40.12000, 0.00000, 7980.16000, 43.28000, 0.00000, 7980.16000, 46.44000, 0.00045,
                  7980.16000, 49.60000, 0.00000, 7980.16000, 52.76000, 0.00000, 7980.16000, 55.92000, 0.00000,
                  7980.16000, 59.08000, 0.00000, 7980.16000, 62.24000, 0.00000, 7980.16000, 65.40000, 0.00045,
                  7980.16000, 68.56000, 0.00000, 7980.16000, 71.72000, 0.00045, 7980.16000, 74.88000, 0.00045,
                  7980.16000, 78.04000, 0.00000, 7980.16000, 81.20000, 0.00000, 7980.16000, 84.36000, 0.00000,
                  7980.16000, 87.52000, 0.00000, 7980.16000, 90.68000, 0.00000, 7980.16000, 93.84000, 0.00000,
                  7980.16000, 97.00000, 0.00000, 7980.16000, 100.16000, 0.00000, 7980.16000, 103.32000, 0.00000,
                  8360.12000, 11.68000, 0.00000, 8360.12000, 14.84000, 0.00000, 8360.12000, 18.00000, 0.00000,
                  8360.12000, 21.16000, 0.00000, 8360.12000, 24.32000, 0.00000, 8360.12000, 27.48000, 0.00000,
                  8360.12000, 30.64000, 0.00000, 8360.12000, 33.80000, 0.00000, 8360.12000, 36.96000, 0.00000,
                  8360.12000, 40.12000, 0.00000, 8360.12000, 43.28000, 0.00000, 8360.12000, 46.44000, 0.00000,
                  8360.12000, 49.60000, 0.00000, 8360.12000, 52.76000, 0.00000, 8360.12000, 55.92000, 0.00000,
                  8360.12000, 59.08000, 0.00000, 8360.12000, 62.24000, 0.00000, 8360.12000, 65.40000, 0.00000,
                  8360.12000, 68.56000, 0.00000, 8360.12000, 71.72000, 0.00000, 8360.12000, 74.88000, 0.00000,
                  8360.12000, 78.04000, 0.00000, 8360.12000, 81.20000, 0.00000, 8360.12000, 84.36000, 0.00000,
                  8360.12000, 87.52000, 0.00000, 8360.12000, 90.68000, 0.00000, 8360.12000, 93.84000, 0.00000,
                  8360.12000, 97.00000, 0.00000, 8360.12000, 100.16000, 0.00000, 8360.12000, 103.32000, 0.00000,
                  8740.08000, 11.68000, 0.00000, 8740.08000, 14.84000, 0.00000, 8740.08000, 18.00000, 0.00000,
                  8740.08000, 21.16000, 0.00000, 8740.08000, 24.32000, 0.00000, 8740.08000, 27.48000, 0.00000,
                  8740.08000, 30.64000, 0.00045, 8740.08000, 33.80000, 0.00045, 8740.08000, 36.96000, 0.00000,
                  8740.08000, 40.12000, 0.00000, 8740.08000, 43.28000, 0.00000, 8740.08000, 46.44000, 0.00090,
                  8740.08000, 49.60000, 0.00000, 8740.08000, 52.76000, 0.00000, 8740.08000, 55.92000, 0.00000,
                  8740.08000, 59.08000, 0.00045, 8740.08000, 62.24000, 0.00045, 8740.08000, 65.40000, 0.00045,
                  8740.08000, 68.56000, 0.00045, 8740.08000, 71.72000, 0.00000, 8740.08000, 74.88000, 0.00000,
                  8740.08000, 78.04000, 0.00000, 8740.08000, 81.20000, 0.00000, 8740.08000, 84.36000, 0.00000,
                  8740.08000, 87.52000, 0.00000, 8740.08000, 90.68000, 0.00000, 8740.08000, 93.84000, 0.00000,
                  8740.08000, 97.00000, 0.00000, 8740.08000, 100.16000, 0.00000, 8740.08000, 103.32000, 0.00000,
                  9120.04000, 11.68000, 0.00000, 9120.04000, 14.84000, 0.00000, 9120.04000, 18.00000, 0.00000,
                  9120.04000, 21.16000, 0.00000, 9120.04000, 24.32000, 0.00000, 9120.04000, 27.48000, 0.00000,
                  9120.04000, 30.64000, 0.00000, 9120.04000, 33.80000, 0.00000, 9120.04000, 36.96000, 0.00000,
                  9120.04000, 40.12000, 0.00000, 9120.04000, 43.28000, 0.00000, 9120.04000, 46.44000, 0.00000,
                  9120.04000, 49.60000, 0.00000, 9120.04000, 52.76000, 0.00000, 9120.04000, 55.92000, 0.00000,
                  9120.04000, 59.08000, 0.00000, 9120.04000, 62.24000, 0.00000, 9120.04000, 65.40000, 0.00000,
                  9120.04000, 68.56000, 0.00000, 9120.04000, 71.72000, 0.00000, 9120.04000, 74.88000, 0.00000,
                  9120.04000, 78.04000, 0.00000, 9120.04000, 81.20000, 0.00000, 9120.04000, 84.36000, 0.00000,
                  9120.04000, 87.52000, 0.00000, 9120.04000, 90.68000, 0.00000, 9120.04000, 93.84000, 0.00000,
                  9120.04000, 97.00000, 0.00000, 9120.04000, 100.16000, 0.00000, 9120.04000, 103.32000, 0.00000,
                  9500.00000, 11.68000, 0.00000, 9500.00000, 14.84000, 0.00000, 9500.00000, 18.00000, 0.00000,
                  9500.00000, 21.16000, 0.00000, 9500.00000, 24.32000, 0.00000, 9500.00000, 27.48000, 0.00000,
                  9500.00000, 30.64000, 0.00000, 9500.00000, 33.80000, 0.00000, 9500.00000, 36.96000, 0.00000,
                  9500.00000, 40.12000, 0.00000, 9500.00000, 43.28000, 0.00000, 9500.00000, 46.44000, 0.00000,
                  9500.00000, 49.60000, 0.00000, 9500.00000, 52.76000, 0.00000, 9500.00000, 55.92000, 0.00000,
                  9500.00000, 59.08000, 0.00000, 9500.00000, 62.24000, 0.00000, 9500.00000, 65.40000, 0.00045,
                  9500.00000, 68.56000, 0.00000, 9500.00000, 71.72000, 0.00000, 9500.00000, 74.88000, 0.00000,
                  9500.00000, 78.04000, 0.00000, 9500.00000, 81.20000, 0.00000, 9500.00000, 84.36000, 0.00000,
                  9500.00000, 87.52000, 0.00000, 9500.00000, 90.68000, 0.00000, 9500.00000, 93.84000, 0.00000,
                  9500.00000, 97.00000, 0.00000, 9500.00000, 100.16000, 0.00000, 9500.00000, 103.32000, 0.00000,
                  9879.96000, 11.68000, 0.00000, 9879.96000, 14.84000, 0.00000, 9879.96000, 18.00000, 0.00000,
                  9879.96000, 21.16000, 0.00000, 9879.96000, 24.32000, 0.00000, 9879.96000, 27.48000, 0.00000,
                  9879.96000, 30.64000, 0.00000, 9879.96000, 33.80000, 0.00000, 9879.96000, 36.96000, 0.00000,
                  9879.96000, 40.12000, 0.00000, 9879.96000, 43.28000, 0.00000, 9879.96000, 46.44000, 0.00000,
                  9879.96000, 49.60000, 0.00000, 9879.96000, 52.76000, 0.00000, 9879.96000, 55.92000, 0.00000,
                  9879.96000, 59.08000, 0.00000, 9879.96000, 62.24000, 0.00000, 9879.96000, 65.40000, 0.00000,
                  9879.96000, 68.56000, 0.00000, 9879.96000, 71.72000, 0.00000, 9879.96000, 74.88000, 0.00000,
                  9879.96000, 78.04000, 0.00000, 9879.96000, 81.20000, 0.00000, 9879.96000, 84.36000, 0.00000,
                  9879.96000, 87.52000, 0.00000, 9879.96000, 90.68000, 0.00000, 9879.96000, 93.84000, 0.00000,
                  9879.96000, 97.00000, 0.00000, 9879.96000, 100.16000, 0.00000, 9879.96000, 103.32000, 0.00000,
                  10259.92000, 11.68000, 0.00000, 10259.92000, 14.84000, 0.00000, 10259.92000, 18.00000, 0.00000,
                  10259.92000, 21.16000, 0.00000, 10259.92000, 24.32000, 0.00000, 10259.92000, 27.48000, 0.00000,
                  10259.92000, 30.64000, 0.00000, 10259.92000, 33.80000, 0.00000, 10259.92000, 36.96000, 0.00000,
                  10259.92000, 40.12000, 0.00000, 10259.92000, 43.28000, 0.00000, 10259.92000, 46.44000, 0.00000,
                  10259.92000, 49.60000, 0.00000, 10259.92000, 52.76000, 0.00000, 10259.92000, 55.92000, 0.00000,
                  10259.92000, 59.08000, 0.00000, 10259.92000, 62.24000, 0.00000, 10259.92000, 65.40000, 0.00000,
                  10259.92000, 68.56000, 0.00000, 10259.92000, 71.72000, 0.00000, 10259.92000, 74.88000, 0.00000,
                  10259.92000, 78.04000, 0.00000, 10259.92000, 81.20000, 0.00000, 10259.92000, 84.36000, 0.00000,
                  10259.92000, 87.52000, 0.00000, 10259.92000, 90.68000, 0.00000, 10259.92000, 93.84000, 0.00000,
                  10259.92000, 97.00000, 0.00000, 10259.92000, 100.16000, 0.00000, 10259.92000, 103.32000, 0.00000]
    allbus_emp = np.array(allbus_emp)
    allbus_emp.shape = (900, 3)
    allbus_p = allbus_emp[:, 2]
    allbus_x, allbus_y = utils.reconstruct_dummy_x_y(allbus_p)


def iris_kde():
    from sklearn import datasets
    iris = datasets.load_iris()
    X = iris.data[:, :2].transpose()
    X = utils.normalize_data(X)
    mykernel = kde_kernel(X)

    kde1 = support_kde(mykernel)
    plotting.plot_combined(kde1['x'], kde1['y'], kde1['pdf'], k=[3, 5, 7, 10])


if __name__ == '__main__':
    # iris
    iris_kde()
